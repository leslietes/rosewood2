<!-- START CONTENT -->
<section class="container clearfix">
  <!-- Page Title -->
  <header class="container page_info clearfix">
    <h1 class="regular brown bottom_line no_print">Settings</h1>
    <div class="clear"></div>
  </header>
  <!-- /Page Title -->

  <div class="col_1_4 no_print">
    <%= render :partial => '/shared/menu_sidebar' %>
  </div>
  
  <div class="col_3_4 last">
    <!--h3 class="red">Settings</h3-->
    
    <h3 class="center no_print">Occupancy Details</h3>

    <p id="notice"><%= notice %></p>
    
    <p>
      <%= label_tag :room_no %>:
      <%= @checkin.first.room_no %><br/>
      <%= label_tag :start_date %>:
      <%= @checkin.first.start_date %>
    </p>
    <div class="clear padding20"></div>
    
    <h3 class="center">Occupants</h3>
    
    <table>
      <thead>
        <th>Name</th>
        <th>Start Date</th>
        <th>End Date</th>
        <th class="no_print">Actions</th>
      </thead>
      <tbody>
        <% @checkin.each do |occupant| %>
        <tr>
          <td><%= "#{occupant.first_name} #{occupant.last_name}" %></td>
          <td><%= occupant._sdate %></td>
          <td><%= occupant._edate %></td>
          <td class="no_print"><%= link_to 'Remove Occupant', remove_occupant_room_url(occupant.occupant_id) if occupant._edate.nil? %></td>
        </tr>
        <% end %>
      </tbody>
    </table>
    
    <div class="no_print">
      
      <div style="width:auto;display:inline-block">
      <%= form_tag transfer_room_url(@checkin.first.id) do %>
        <%= hidden_field_tag :room_id, @checkin.first.room_id %>
        New Room Number: 
        <%= select_tag "new_room_id", options_for_select(@rooms), prompt: "Select room" %>
        <%= submit_tag 'Tranfer Room' %>
        <%= link_to 'Vacate Room', vacate_room_url(@checkin.first), class: "styled_links" %>
      <% end %>
      
    </div>
      
    </div>
    
    <div class="clear padding20"></div>
    
    <span class="no_print"><i>'Remove Occupant' is for when an occupant leaves the room, but someone else is left behind.<br/> Do not use 'Remove Occupant' when vacating entire room.</i></span>
    
    <div class="clear padding20"></div>
    
    <h3 class="center">Billing Components</h3>
    
    <table>
      <thead>
        <th>Item</th>
        <th colspan="1" class="no_print">Actions</th>
      </thead>
      <tbody>
        
      <% @details.each do |detail| %>
        <tr>
            <td class="left"><%= detail.utility.name %></td>
            <%#= to_currency(detail.amount) %>
            <%#= detail.start_date %>
            <%#= detail.end_date   %>
            <td class="no_print"><%= link_to 'Remove', remove_utility_room_url(detail.id) %></td>
      </tr>
      <% end %>
    </tbody>
    </table>
    <span class="no_print"><i>These are items added when generating billing statements. Remove one-time items such as Cable TV Installation, Cable TV Termination, Transcient Fees and Damages, and add them as needed.</i></span>
    
    <div class="clear padding20"></div>
    
    <div class="no_print">
      <%= link_to 'PRINT', occupancy_details_room_url(@checkin.first, format: "pdf"), class: "styled_links" %> 
    </div>
    
    <div class="clear padding20"></div>
    <div class="clear padding20"></div>
    
    
    <div class="no_print">
    <%= form_tag new_roommate_room_path(id: @checkin.first.id) do %>
      <p>
        <label>New Roommate</label>
        <%= select_tag "occupants[]", options_for_select(@occupants.map {|o| [o.name, o.id] }), multiple: :multiple, size: 5, prompt: "Select occupant" %><br/>
      </p>
      
      <p>
        <%= label_tag :start_date %>
        <%= date_field_tag :start_date, Date.today %>
      </p>
    
      <p>
        <%= label_tag :utilities %><br/>
        <% @utilities.each do |u| %>
          <%= check_box_tag "utilities[#{u.id}]" %> <%= u.name %> <%= to_currency(u.rate) %><br/>
        <% end %>
      </p>

      <p>     
        <%= submit_tag 'Add' %>
      </p>
      
    <% end %>   
    </div >
  </div>
  
  <div class="clear padding15"></div>
</section>